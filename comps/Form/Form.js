(function(a){!window.JC&&(window.JC={log:function(){}});window.JCForm=JC.Form={disableButton:function(c,b){if(!c){return}c=a(c);b=b||1000;c.attr("disabled",true);setTimeout(function(){c.attr("disabled",false)},b)}}}(jQuery));(function(b){JC.Form.initCheckAll=function(d){d=b(d);var e=d.find("input[type=checkbox][checktype][checkfor]");e.each(function(){var f=b(this),g=f.attr("checktype").toLowerCase(),h=f.attr("checkfor");if(g!="all"||!h){return}a(f,h);if(!f.data("initedCheckall")){f.data("initedCheckall",true);b(document).delegate(h,"click",function(j){var i=b(this);if(c(i)){return}a(f,h)})}})};b(document).ready(function(d){JC.Form.initCheckAll(b(document))});b(document).delegate("input[type=checkbox][checktype][checkfor]","click",function(g){var f=b(this),d=f.attr("checktype").toLowerCase(),e=f.attr("checkfor");JC.log(d,e);switch(d){case"all":b(e).each(function(){var h=b(this);if(c(h)){return}if(h.is("[disabled]")){return}f.prop("checked")&&h.prop("checked",true);!f.prop("checked")&&h.prop("checked",false)});break;case"inverse":b(e).each(function(){var h=b(this);if(c(h)){return}if(h.is("[disabled]")){return}if(h.prop("checked")){h.prop("checked",false)}else{h.prop("checked",true)}});if(f.is("[checkall]")){a(f.attr("checkall"),e)}break}});function c(d){d=b(d);return d.is("[checktype]")&&d.is("[checkfor]")}function a(d,e){var f=true,d=b(d),e=b(e);e.each(function(){var g=b(this);if(c(g)){return}if(g.is("[checktype]")||g.is("[checkfor]")){return}if(!g.prop("checked")){return f=false}});JC.log("_isAll: ",f);d&&d.length&&d.prop("checked",f)}}(jQuery));(function(g){JC.Form.initAutoSelect=d;function d(h){var i=[];h&&(h=g(h));if(d.isSelect(h)){i.push(new f(h))}else{if(h&&h.length){h.find("select[defaultselect]").each(function(){i.push(new f(g(this)))})}}return i}var c={isSelect:function(h){var i;h&&(h=g(h))&&h.is("select")&&h.is("[defaultselect]")&&(i=true);return i},hideEmpty:false,dataFilter:null,beforeInited:null,inited:null,change:null,allChanged:null,triggerInitChange:true,randomurl:false,processUrl:null,getInstance:function(j,h){var i;j&&(j=g(j))&&(typeof h!="undefined"&&j.data("SelectIns",h),i=j.data("SelectIns"));return i}};for(var e in c){d[e]=c[e]}function f(h){this._model=new b(h);this._view=new a(this._model,this);this._init()}f.prototype={_init:function(){var h=this;g.each(h._model.items(),function(i,j){d.getInstance(g(j),h)});h._model.beforeInited()&&h.on("SelectBeforeInited",h._model.beforeInited());h.on("SelectInited",function(){var i=h._model.first();while(h._model.next(i)){i.on("change",h._responeChange);i=h._model.next(i)}h._model.isInited(true);h._model.inited()&&h._model.inited().call(h)});h.on("SelectChange",function(i,j){h._model.change(j)&&h._model.change(j).call(j,i,h)});h._model.allChanged()&&h.on("SelectAllChanged",h._model.allChanged());h.trigger("SelectBeforeInited");h._update(h._model.first(),h._firstInitCb);return h},on:function(h,i){g(this).on(h,i);return this},trigger:function(i,h){g(this).trigger(i,h);return this},first:function(){return this._model.first()},last:function(){return this._model.last()},items:function(){return this._model.items()},isFirst:function(h){return this._model.isFirst(h)},isLast:function(h){return this._model.isLast(h)},isInited:function(){return this._model.isInited()},data:function(h){return this._model.data(h)},_responeChange:function(h){var k=g(this),j=d.getInstance(k),i=j._model.next(k);JC.log("_responeChange:",k.attr("name"),k.val());if(!(i&&i.length)){j.trigger("SelectChange")}else{j._update(i,j._changeCb,k.val())}},_changeCb:function(k,i){var j=this,h=j._model.next(k);j.trigger("SelectChange",[k]);if(j._model.isLast(k)){j.trigger("SelectAllChanged")}if(h&&h.length){JC.log("_changeCb:",k.val(),h.attr("name"),k.attr("name"));j._update(h,j._firstInitCb,k.val())}return this},_firstInitCb:function(k,i){var j=this,h=j._model.next(k);j._model.triggerInitChange()&&(JC.log("triggerInitChange",k.attr("name")),k.trigger("change"));j.trigger("SelectChange",[k]);if(j._model.isLast(k)){j.trigger("SelectAllChanged");j.trigger("SelectInited")}if(h&&h.length){JC.log("_firstInitCb:",k.val(),h.attr("name"),k.attr("name"));j._update(h,j._firstInitCb,k.val())}return this},_update:function(j,i,h){if(this._model.isStatic(j)){this._updateStatic(j,i,h)}else{if(this._model.isAjax(j)){this._updateAjax(j,i,h)}else{this._updateNormal(j,i,h)}}return this},_updateStatic:function(k,i,l){var j=this,h;JC.log("static select");if(j._model.isFirst(k)){typeof l=="undefined"&&(l=j._model.selectparentid(k)||"");if(typeof l!="undefined"){h=j._model.datacb(k)(l)}}else{h=j._model.datacb(k)(l)}j._view.update(k,h);i&&i.call(j,k,h);return this},_updateAjax:function(l,j,n){var k=this,i,m=k._model.next(l),h;JC.log("ajax select");if(k._model.isFirst(l)){typeof n=="undefined"&&(n=k._model.selectparentid(l)||"");if(typeof n!="undefined"){h=k._model.selecturl(l,n);g.get(h,function(o){o=g.parseJSON(o);k._view.update(l,o);j&&j.call(k,l,o)})}}else{h=k._model.selecturl(l,n);g.get(h,function(o){JC.log("_url:",h,n);o=g.parseJSON(o);k._view.update(l,o);j&&j.call(k,l,o)})}return this},_updateNormal:function(k,i,m){var j=this,h;JC.log("normal select");if(j._model.isFirst(k)){var l=j._model.next(k);if(l&&l.length){j._update(l,i,k.val());return this}}else{h=j._model.datacb(k)(m)}j._view.update(k,h);i&&i.call(j,k,h);return this}};function b(h){this._selector=h;this._items=[];this._isInited=false;this._init()}b.prototype={_init:function(){this._findAllItems(this._selector);JC.log("select items.length:",this._items.length);this._initRelationship();return this},_findAllItems:function(h){this._items.push(h);if(h.is("[selecttarget]")){this._findAllItems(g(h.attr("selecttarget")))}},_initRelationship:function(){this._selector.data("FirstSelect",true);if(this._items.length>1){this._items[this._items.length-1].data("LastSelect",true);for(var j=0;j<this._items.length;j++){var h=this._items[j],i=this._items[j-1];if(i){h.data("PrevSelect",i);i.data("NextSelect",h);h.data("parentSelect",i)}}}},items:function(){return this._items},first:function(){return this._items[0]},last:function(){return this._items[this._items-1]},next:function(h){return h.data("NextSelect")},prev:function(h){return h.data("PrevSelect")},isFirst:function(h){return !!h.data("FirstSelect")},isLast:function(h){return !!h.data("LastSelect")},isStatic:function(h){return h.is("[selectdatacb]")},isAjax:function(h){return h.is("[selecturl]")},isInited:function(h){typeof h!="undefined"&&(this._isInited=h);return this._isInited},datacb:function(h){var i;h.attr("selectdatacb")&&(i=window[h.attr("selectdatacb")]);return i},selectparentid:function(h){var i;h.attr("selectparentid")&&(i=h.attr("selectparentid"));h.removeAttr("selectparentid");return i||""},selectvalue:function(h){var i=h.attr("selectvalue");h.removeAttr("selectvalue");return i||""},randomurl:function(h){var i=d.randomurl;h.is("[selectrandomurl]")&&(i=parseBool(h.attr("selectrandomurl")));return i},triggerInitChange:function(){var i=d.triggerInitChange,h=this.first();h.attr("selecttriggerinitchange")&&(i=parseBool(h.attr("selecttriggerinitchange")));return i},hideempty:function(h){var i=d.hideEmpty;h&&h.length&&h.is("[selecthideempty]")&&(i=parseBool(h.attr("selecthideempty")));return i},selecturl:function(j,k){var h=d.processUrl,i=j.attr("selecturl")||"";j.attr("selectprocessurl")&&window[j.attr("selectprocessurl")]&&(h=window[j.attr("selectprocessurl")]);i=printf(i,k);this.randomurl(j)&&(i=add_url_params(i,{rnd:new Date().getTime()}));h&&(i=h.call(j,i,k));return i},_userdatafilter:function(h){var i;h.attr("selectdatafilter")&&(i=window[h.attr("selectdatafilter")]);return i},dataFilter:function(j,i){var h=this._userdatafilter(j)||d.dataFilter;h&&(i=h(i,j));return i},beforeInited:function(){var i=d.beforeInited,h=this.first();h.attr("selectbeforeInited")&&window[h.attr("selectbeforeInited")]&&(i=window[h.attr("selectbeforeinited")]);return i},inited:function(){var i=d.inited,h=this.first();h.attr("selectinited")&&window[h.attr("selectinited")]&&(i=window[h.attr("selectinited")]);return i},change:function(h){var i=d.change;h.attr("selectchange")&&window[h.attr("selectchange")]&&(i=window[h.attr("selectchange")]);return i},allChanged:function(){var i=d.allChanged,h=this.first();h.attr("selectallchanged")&&window[h.attr("selectallchanged")]&&(i=window[h.attr("selectallchanged")]);return i},data:function(h,i){typeof i!="undefined"&&(h.data("SelectData",i));return h.data("SelectData")},hasVal:function(j,i){var h=false,i=i.toString();j.find("option").each(function(){var k=g(this);if(k.val()==i){h=true;return false}});return h}};function a(i,h){this._model=i;this._control=h;this._init()}a.prototype={_init:function(){return this},update:function(o,l){var n=this._model.selectvalue(o);l=this._model.dataFilter(o,l);this._model.data(o,l);this._control.trigger("SelectItemBeforeUpdate",[o,l]);this._removeExists(o);if(!l.length){if(this._model.hideempty(o)){o.hide();this._control.trigger("SelectItemUpdated",[o,l]);return}}else{!o.is(":visible")&&o.show()}var h=[],k,m;for(var j=0,i=l.length;j<i;j++){k=l[j];h.push(printf('<option value="{0}" {2}>{1}</option>',k[0],k[1],m))}g(h.join("")).appendTo(o);if(this._model.hasVal(o,n)){o.val(n)}this._control.trigger("SelectItemUpdated",[o,l])},_removeExists:function(h){h.find("> option:not([defaultoption])").remove()}};g(document).ready(function(h){setTimeout(function(){d(document.body)},100)})}(jQuery));(function(c){JC.Form.initAutoFill=function(d,e){if(!(d&&d.length)){d=c(document)}e=e||location.href;JC.log("JC.Form.initAutoFill");d.find("form.js_autoFillUrlForm").each(function(){var f=c(this);f.find("input[type=text][name],input[type=password][name],textarea[name]").each(function(){var g=c(this);if(has_url_param(e,g.attr("name"))){g.val(a(get_url_param(e,g.attr("name")).replace(/[\+]/g," ")))}});f.find("select[name]").each(function(){var g=c(this),h=a(get_url_param(e,g.attr("name")).replace(/[\+]/g," "));if(has_url_param(e,g.attr("name"))){if(b(g,h)){g.val(get_url_param(e,g.attr("name")))}else{g.attr("selectvalue",h)}}})})};c(document).ready(function(d){JC.Form.initAutoFill()});JC.Form.initAutoFill.decodeFunc;function a(e){try{e=(JC.Form.initAutoFill.decodeFunc||decodeURIComponent)(e)}catch(d){}return e}function b(f,e){var d=false,e=e.toString();f.find("option").each(function(){var g=c(this);if(g.val()==e){d=true;return false}});return d}}(jQuery));(function(a){JC.Form.initNumericStepper=function(c){c&&(c=a(c));c.delegate(".js_NStepperPlus, .js_NStepperMinus","click",function(k){var g=a(this),j=b.target(g);if(!(j&&j.length)){return}var i=parseInt(b.fixed(j),10)||0;var e=a.trim(j.val()),d=b.step(j);e=(i?parseFloat(e):parseInt(e,10))||0;var f=b.minvalue(j),h=b.maxvalue(j);g.hasClass("js_NStepperPlus")&&(e+=d);g.hasClass("js_NStepperMinus")&&(e-=d);e<f&&(e=f);e>h&&(e=h);JC.log(f,h,e,i,d);j.val(e.toFixed(i));b.callback(j)&&b.callback(j).call(j,g)})};JC.Form.initNumericStepper.onchange;var b={target:function(d){var c;if(d.attr("nstarget")){if(/^\~/.test(d.attr("nstarget"))){c=d.parent().find(d.attr("nstarget").replace(/^\~[\s]*/g,""));!(c&&c.length)&&(c=a(d.attr("nstarget")))}else{c=a(d.attr("nstarget"))}}return c},fixed:function(c){return c.attr("nsfixed")},step:function(c){return parseFloat(c.attr("nsstep"))||1},minvalue:function(c){return parseFloat(c.attr("nsminvalue")||c.attr("minvalue"))||0},maxvalue:function(c){return parseFloat(c.attr("nsmaxvalue")||c.attr("maxvalue"))||100},callback:function(e){var d=JC.Form.initNumericStepper.onchange,c;e.attr("nschangecallback")&&(c=window[e.attr("nschangecallback")])&&(d=c);return d}};a(document).ready(function(c){JC.Form.initNumericStepper(a(document))})}(jQuery));