(function(b){!window.JC&&(window.JC={log:function(){}});window.ZINDEX_COUNT=window.ZINDEX_COUNT||50001;window.Slider=JC.Slider=a;function a(f){f&&(f=b(f));if(a.getInstance(f)){return a.getInstance(f)}a.getInstance(f,this);JC.log("Slider constructor",new Date().getTime());this._model=new c(f);switch(this._model.direction()){case"vertical":this._view=new d(this._model,this);break;default:this._view=new e(this._model,this);break}this._init()}a.prototype={_init:function(){var f=this;f._initControl();f.on("cleartinterval",function(){f._model.clearInterval();f._view.setPagePosition()});f.on("cleartimeout",function(){f._model.clearTimeout()});f._initAutoMove();f._model.initedcb()&&f.on("inited",f._model.initedcb());f.trigger("inited");return this},on:function(g,f){b(this).on(g,f);return this},trigger:function(f){b(this).trigger(f);return this},move:function(f){this._view.move(f);return this},moveTo:function(f){this._view.moveTo(f);return this},totalpage:function(){return this._model.totalpage()},pointer:function(){return this._model.pointer()},page:function(f){return this._model.page(f)},layout:function(){return this._model.layout()},find:function(f){return this._model.layout().find(f)},_initControl:function(){switch(this._model.direction()){case"vertical":this._initVerticalControl();break;default:this._initHorizontalControl();break}},_initHorizontalControl:function(){var f=this;f._model.leftbutton()&&f._model.leftbutton().on("click",function(g){f.trigger("cleartimeout");f.trigger("movetoleft");f._view.move(1)}).on("mouseenter",function(){f.trigger("controlover")}).on("mouseleave",function(){f.trigger("controlout")});f._model.rightbutton()&&f._model.rightbutton().on("click",function(g){f.trigger("cleartimeout");f.trigger("movetoright");f._view.move()}).on("mouseenter",function(){f.trigger("controlover")}).on("mouseleave",function(){f.trigger("controlout")})},_initVerticalControl:function(){var f=this},_initAutoMove:function(){var f=this;if(!f._model.automove()){return}f.on("beforemove",function(h,g,i){f.trigger("cleartimeout")});f.on("movedone",function(h,g,i){if(f._model.controlover()){return}f.trigger("automove")});f._model.layout().on("mouseenter",function(g){f.trigger("cleartimeout");f.trigger("mouseenter")});f._model.layout().on("mouseleave",function(g){f.trigger("cleartimeout");f.trigger("mouseleave");f._view.setPagePosition();f.trigger("automove")});f.on("controlover",function(){f.trigger("cleartimeout");f._model.controlover(true)});f.on("controlout",function(){f.trigger("automove");f._model.controlover(false)});f.on("movetoleft",function(){f._model.moveDirection(false)});f.on("movetoright",function(){f._model.moveDirection(true)});b(f).on("automove",function(){f._model.timeout(setTimeout(function(){f._view.moveTo(f._model.automoveNewPointer())},f._model.automovems()))});f.trigger("automove");return this}};a.autoInit=true;a.init=function(g){var f=[];g&&(g=b(g));if(g&&g.length){if(a.isSlider(g)){if(a.getInstance(g)){return[a.getInstance(g)]}f.push(new a(g))}else{g.find("div.js_autoSlider, dl.js_autoSlider, ul.js_autoSlider, ol.js_autoSlider").each(function(){if(a.isSlider(this)){if(a.getInstance(b(this))){f.push(a.getInstance(b(this)));return}f.push(new a(b(this)))}})}}return f};a.getInstance=function(f,g){g&&f&&b(f).data("SliderIns",g);return f?b(f).data("SliderIns"):null};a.isSlider=function(f){f&&(f=b(f));return f&&(f.is("[sliderwidth]")||f.is("[sliderheight]"))};function c(f){this._layout=f;this._moveDirection=true;this._interval;this._timeout;this._init()}c.prototype={_init:function(){this.subitems();this.totalpage();JC.log(printf("w:{0}, h:{1}, iw:{2}, ih:{3}, dr:{4}, si:{6}, hi:{5}, totalpage:{7}",this.width(),this.height(),this.itemwidth(),this.itemheight(),this.direction(),this.howmanyitem(),this.subitems().length,this.totalpage()));return this},layout:function(){return this._layout},leftbutton:function(){return this._layout.is("[sliderleft]")?b(this._layout.attr("sliderleft")):null},rightbutton:function(){return this._layout.is("[sliderright]")?b(this._layout.attr("sliderright")):null},direction:function(){return this._layout.attr("sliderdirection").toLowerCase()||"horizontal"},moveDirection:function(f){typeof f!="undefined"&&(this._moveDirection=f);JC.log("moveDirection",this._moveDirection);return this._moveDirection},howmanyitem:function(){return parseInt(this._layout.attr("sliderhowmanyitem"),10)||1},width:function(){return parseInt(this._layout.attr("sliderwidth"),10)||800},height:function(){return parseInt(this._layout.attr("sliderheight"),10)||230},itemwidth:function(){return parseInt(this._layout.attr("slideritemwidth"),10)||160},itemheight:function(){return parseInt(this._layout.attr("slideritemheight"),10)||230},loop:function(){return parseBool(this._layout.attr("sliderloop"))},stepms:function(){return parseInt(this._layout.attr("sliderstepms"),10)||10},durationms:function(){return parseInt(this._layout.attr("sliderdurationms"),10)||300},automovems:function(){return parseInt(this._layout.attr("sliderautomovems"),10)||2000},automove:function(){return parseBool(this._layout.attr("sliderautomove"))},defaultpage:function(){return parseInt(this._layout.attr("sliderdefaultpage"),10)||0},subitems:function(){if(this._layout.is("[slidersubitems]")){this._subitems=this._layout.find(this._layout.attr("slidersubitems"))}else{this._subitems=this._layout.children()}return this._subitems},totalpage:function(){this.subitems();if(this.howmanyitem()>1){this._totalpage=Math.ceil(this._subitems.length/this.howmanyitem())}else{this._totalpage=this._subitems.length}return this._totalpage},page:function(g){this.subitems();!g&&(g=0);g<0&&(g=0);g>=this.totalpage()&&(g=this.totalpage()-1);g*=this.howmanyitem();var f=[];for(var h=g,i=0;i<this.howmanyitem()&&h<this._subitems.length;h++,i++){f.push(b(this._subitems[h]))}return f},pointer:function(f){if(typeof this._pointer=="undefined"){this._pointer=this.defaultpage()}if(typeof f!="undefined"){this._pointer=this.fixpointer(f)}return this._pointer},newpointer:function(f){var g=this.pointer();f&&g--;!f&&g++;g=this.fixpointer(g);return g},fixpointer:function(f){var g=f;if(this.loop()){g<0&&(g=this.totalpage()-1);g>=this.totalpage()&&(g=0)}else{g<0&&(g=0);g>=this.totalpage()&&(g=this.totalpage()-1)}return g},automoveNewPointer:function(){var f=this.pointer();if(this.moveDirection()){f++}else{f--}if(this.loop()){if(f>=this.totalpage()){f=0}else{if(f<0){f=this.totalpage()-1}}}else{if(f>=this.totalpage()){f=this.totalpage()-2;this.moveDirection(false)}else{if(f<0){f=1;this.moveDirection(true)}}}return f},interval:function(f){typeof f!="undefined"&&(this._interval=f);return this._interval},clearInterval:function(){this.interval()&&clearInterval(this.interval())},timeout:function(f){typeof f!="undefined"&&(this._timeout=f);return this._timeout},clearTimeout:function(){this.timeout()&&clearTimeout(this.timeout())},controlover:function(f){typeof f!="undefined"&&(this._controlover=f);return this._controlover},initedcb:function(){this._layout.is("[sliderinitedcb]")&&window[this._layout.attr("sliderinitedcb")]&&(this._initedcb=window[this._layout.attr("sliderinitedcb")]);return this._initedcb}};function e(f,g){this._model=f;this._slider=g;this._itemspace=(this._model.width()-Math.floor(this._model.width()/this._model.itemwidth())*this._model.itemwidth())/(this._model.totalpage()-1);this._itemspace=parseInt(this._itemspace);this._init()}e.prototype={_init:function(){this.setPagePosition(this._model.pointer());return this},move:function(g){var h=this;g=!!g;JC.log("HorizontalView move, is backwrad",g,this._model.pointer());var f=this._model.newpointer(g);JC.log(printf("is backwrad: {0}, pointer:{1}, new pointer:{2}",g,this._model.pointer(),f));this.moveTo(f)},moveTo:function(k){var h=this;if(!this._model.loop()){if(k<=this._model.pointer()&&this._model.pointer()===0){b(this._slider).trigger("outmin");return}if(k>=this._model.pointer()&&this._model.pointer()>=this._model.totalpage()-1){b(this._slider).trigger("outmax");return}}k=this._model.fixpointer(k);var g=this._model.pointer();if(k===g){return}var f=this._model.page(g),j=this._model.page(k);var i=f.concat(j);this._setNewPagePosition(f,j,g,k);h._model.pointer(k)},_setNewPagePosition:function(g,i,f,m){var k=this,h,l=g.concat(i),j;b(this._slider).trigger("cleartinterval");if(f<m){h=this._model.width()+this._itemspace}else{h=-(this._model.width()+this._itemspace);j=true}f===(k._model.totalpage()-1)&&m===0&&(h=this._model.width()+this._itemspace,j=false);f===0&&m===(k._model.totalpage()-1)&&(h=-(this._model.width()+this._itemspace),j=true);b.each(i,function(p,o){var n=b(o);n.css({left:h+k._model.itemwidth()*p+k._itemspace*p+"px"});n.show()});b(k._slider).trigger("beforemove",[f,m]);b.each(l,function(o,n){n.data("TMP_LEFT",n.prop("offsetLeft"))});JC.log("zzzzzzzzzz",h,this._itemspace,this._model.moveDirection());k._model.interval(easyEffect(function(n,o){b(l).each(function(p,q){q.css({left:q.data("TMP_LEFT")+(j?n:-n)+"px"})});if(o){b(g).each(function(p,q){q.hide()});b(k._slider).trigger("movedone",[f,m]);k._model.pointer(m);k.setPagePosition()}},this._model.width(),0,this._model.durationms(),this._model.stepms()))},setPagePosition:function(g){JC.log("view setPagePosition",new Date().getTime());typeof g=="undefined"&&(g=this._model.pointer());this._model.subitems().hide();var f=this._model.page(g);for(var i=0,h=f.length;i<h;i++){f[i].css({left:i*this._model.itemwidth()+i*this._itemspace+"px"}).show()}JC.log(f.length)}};function d(f,g){this._model=f;this._slider=g;this._itemspace=0;this._init()}d.prototype={_init:function(){this.setPagePosition(this._model.pointer());return this},move:function(g){var f=this;return this},moveTo:function(g){var f=this;return this},_setNewPagePosition:function(g,i,f,m){var k=this,h,l=g.concat(i),j;return this},setPagePosition:function(g){var f=this;JC.log("view setPagePosition",new Date().getTime());return this}};b(document).ready(function(){if(!a.autoInit){return}a.init(document.body)})}(jQuery));