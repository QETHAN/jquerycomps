(function(a){!window.JC&&(window.JC={log:function(){}});window.ZINDEX_COUNT=window.ZINDEX_COUNT||50001;window.Tips=JC.Tips=b;function b(g){g=a(g);if(!(g&&g.length)){return this}if(g.length>1){return b.init(g)}if(b.getInstance(g)){return b.getInstance(g)}b.getInstance(g,this);this._model=new d(g);this._view=new c(this._model);this._init()}b.prototype={_init:function(){var g=this;a(this._view).on("BindEvent",function(i,h,j){g.on(h,j)});a(this._view).on("TriggerEvent",function(i,h,j){g.trigger(h,j)});this._view.init();this._model.selector().on("mouseenter",e);return this},show:function(g){this._view.show(g);return this},hide:function(){this._view.hide();return this},selector:function(){return this._model.selector()},layout:function(g){return this._view.layout(g)},data:function(){return this._model.data()},on:function(h,g){a(this).on(h,g);return this},trigger:function(g){a(this).trigger(g);return this}};b.init=function(g){if(!g){return}g=a(g);if(!g.length){return}var h=[];g.each(function(){var i=a(this);if(b.getInstance(i)){return}h.push(new b(i))});return h};b.hide=function(){a("body > div.UTips").hide()};b.autoInit=true;b.tpl=null;b.offset={bottom:{x:15,y:15},left:{x:-28,y:5},top:{x:-2,y:-22}};b.minWidth=200;b.maxWidth=400;b.titleToTipsdata=function(g){g=a(g);if(!JC.Tips.autoInit||(typeof window.event=="object"&&document.attachEvent)){g.each(function(){a(this).attr("tipsData",a(this).attr("title")).removeAttr("title")})}};b.getInstance=function(g,h){h&&g&&a(g).data("TipsIns",h);return g?a(g).data("TipsIns"):null};function d(g){this.tpl=f;this._selector=g;this._data;this._init()}d.prototype={_init:function(){this.update();return this},data:function(g){g&&this.update();return this._data},update:function(){if(!(this._selector.attr("title")||this._selector.attr("tipsData"))){return}this._data=a.trim(this._selector.attr("title")||this._selector.attr("tipsData")).replace(/(?:\r\n|\n\r|\r|\n)/g,"<br />");this._selector.removeAttr("title").removeAttr("tipsData");if(this.isInited()){return}this.isInited(true)},isInited:function(g){typeof g!="undefined"&&(this._selector.data("initedTips",g));return this._selector.data("initedTips")},selector:function(){return this._selector},tipsinitedcallback:function(){var g;this._selector.attr("tipsinitedcallback")&&(g=window[this._selector.attr("tipsinitedcallback")]);return g},tipsshowcallback:function(){var g;this._selector.attr("tipsshowcallback")&&(g=window[this._selector.attr("tipsshowcallback")]);return g},tipshidecallback:function(){var g;this._selector.attr("tipshidecallback")&&(g=window[this._selector.attr("tipshidecallback")]);return g},tipstemplatebox:function(){var g;this._selector.is("[tipstemplatesbox]")&&(g=a(this._selector.attr("tipstemplatesbox")).html().trim().replace(/[\r\n]+/g,""));return g},tipstemplatesbox:function(){return this.tipstemplatebox()},layout:function(){if(!this._layout){if(this.tipstemplatesbox()){this._layout=a(this.tipstemplatesbox());this._layout.appendTo(document.body)}else{this._layout=a("#JCTipsLayout");if(!(this._layout&&this._layout.length)){this._layout=a(this.tipstemplatesbox()||JC.Tips.tpl||this.tpl);this._layout.attr("id","JCTipsLayout").css("position","absolute");this._layout.appendTo(document.body)}}}return this._layout}};function c(g){this._model=g;this._layout}c.prototype={init:function(){a(this).trigger("BindEvent",["TipsShow",this._model.tipsshowcallback()]);a(this).trigger("BindEvent",["TipsHide",this._model.tipshidecallback()]);a(this).trigger("BindEvent",["TipsInited",this._model.tipsinitedcallback()]);return this},show:function(p){var q=p.pageX,o=p.pageY;q+=JC.Tips.offset.bottom.x;o+=JC.Tips.offset.bottom.y;var l=a(document).scrollTop(),k=a(document).scrollLeft();var s=a(window).width(),u=a(window).height();var r=this.layout().width(),m=this.layout().height();var h=k+s-r,j=k;var g=l+u-m,i=l;var t=false,n=false;q>h&&(q=q-r+JC.Tips.offset.left.x,o+=JC.Tips.offset.left.y,t=true);q<j&&(q=j);o>g&&(o=o-m+JC.Tips.offset.top.y,q+=JC.Tips.offset.top.x,n=true);o<i&&(o=i);t&&n&&(o-=5);this.layout().css({left:q+"px",top:o+"px"});this.layout().show();a(this).trigger("TriggerEvent",["TipsShow",this._model.tipsshowcallback()])},hide:function(){this.layout().hide();a(this).trigger("TriggerEvent","TipsHide")},layout:function(i){this._layout=this._model.layout();if(i){var g=this._model.data(i);this._layout.html(g).css({width:"auto",left:"-9999px",top:"-9999px",display:"block"});var j=this._layout.width(),h=this._layout.height();j<JC.Tips.minWidth&&this._layout.css("width",JC.Tips.minWidth+"px");j>JC.Tips.maxWidth&&this._layout.css("width",JC.Tips.maxWidth+"px")}return this._layout}};function e(g){var k=a(this),j=b.getInstance(k);j.layout(1).css("z-index",ZINDEX_COUNT++);if(!j.data()){return}j.show(g);a(document).on("mousemove",i);k.on("mouseleave",h);function i(l){if(!j.layout().is(":visible")){a(document).unbind("mousemove",i);a(k).unbind("mouseleave",h);return}j.show(l)}function h(l){a(document).unbind("mousemove",i);a(k).unbind("mouseleave",h);j.hide()}}var f='<div class="UTips"></div>';a(document).ready(function(g){setTimeout(function(){if(!JC.Tips.autoInit){return}b.titleToTipsdata(a("[title]"));a(document).delegate("*","mouseover",function(h){var i=a(this);if(b.getInstance(i)){return}if(!(i.attr("title")||i.attr("tipsData"))){return}JC.Tips.init(i);e.call(this,h)})},10)})}(jQuery));